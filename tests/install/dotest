#!/bin/bash

rm -f q

. ../init.sh

applets=$(q -Ch | \
	sed -n '/^Currently defined applets:/,/^Options/p' | \
	grep ' : ' | \
	awk '{print $1}'
)
rm -f ${applets}

if ! ln -f `which q` ; then
	skip "could not 'ln -f'"
fi
f./q -i || die "./q -i"

for app in ${applets} ; do
	if [ ! -e $app ] ; then
		tfail "$app does not exist"
	elif [ "$app" != "q" ] ; then
		t=$(readlink $app)
		if [ "$t" != "q" ] ; then
			tfail "$app target is not 'q', it is '$t'"
		else
			tpass "${app}"
		fi
	fi
done
rm ${applets}

end
